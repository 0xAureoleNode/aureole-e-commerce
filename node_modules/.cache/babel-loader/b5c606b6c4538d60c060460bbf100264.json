{"ast":null,"code":"import _objectSpread from\"/Users/hanziniu/aureole-e-commerce/e-commerce/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/hanziniu/aureole-e-commerce/e-commerce/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/hanziniu/aureole-e-commerce/e-commerce/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";// Import the functions you need from the SDKs you need\nimport{initializeApp}from'firebase/app';import{getAuth,signInWithRedirect,signInWithPopup,GoogleAuthProvider,createUserWithEmailAndPassword,signInWithEmailAndPassword,signOut,onAuthStateChanged}from'firebase/auth';// TODO: Add SDKs for Firebase products that you want to use\n// https://firebase.google.com/docs/web/setup#available-libraries\nimport{getFirestore,doc,getDoc,setDoc,collection,writeBatch,query,getDocs}from'firebase/firestore';// upload these categories from that shop data up into the collections\n// Your web app's Firebase configuration\nvar firebaseConfig={apiKey:'AIzaSyALOjtn7jZIEUziIpNHxVfeOdOEoQDP3V8',authDomain:'e-commerce-db-9450a.firebaseapp.com',projectId:'e-commerce-db-9450a',storageBucket:'e-commerce-db-9450a.appspot.com',messagingSenderId:'731145164187',appId:'1:731145164187:web:e34c39bf7ec0e911acfd3e'};// Initialize Firebase\nvar app=initializeApp(firebaseConfig);// Create an instance of the Google provider object - https://firebase.google.com/docs/auth/web/google-signin\nvar googleProvider=new GoogleAuthProvider();googleProvider.setCustomParameters({// Forces account selection even when one account\n// is available.\nprompt:'select_account'});// Initialize Firebase Authentication\nexport var auth=getAuth();export var signInWithGooglePopup=function signInWithGooglePopup(){return signInWithPopup(auth,googleProvider);};export var signInWithGoogleRedirect=function signInWithGoogleRedirect(){return signInWithRedirect(auth,googleProvider);};// Initialize Cloud Firestore\nexport var db=getFirestore();export var addCollectionAndDocuments=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(collectionKey,objectsToAdd){var collectionRef,batch;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:collectionRef=collection(db,collectionKey);// init the batch and pass db\nbatch=writeBatch(db);objectsToAdd.forEach(function(object){var docRef=doc(collectionRef,object.title.toLowerCase());batch.set(docRef,object);});_context.next=5;return batch.commit();case 5:console.log('done');case 6:case\"end\":return _context.stop();}}},_callee);}));return function addCollectionAndDocuments(_x,_x2){return _ref.apply(this,arguments);};}();//  best isolate and minimize the impact\nexport var getCategoriesAndDocuments=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var collectionRef,q,querySnapshot,categoryMap;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:// references : A reference is a lightweight object that just points to a location in your database.\n// create references to the categories collection\ncollectionRef=collection(db,'categories');// create a query against the categories collection\nq=query(collectionRef);// Execute a query\n// use get() to retrieve the results:\n// getDocs() : Executes the query and returns the results as a QuerySnapshot.\n_context2.next=4;return getDocs(q);case 4:querySnapshot=_context2.sent;// A QuerySnapshot contains the results of a query. It can contain zero or more DocumentSnapshot objects.\n// querySnapshot.docs will give an array of all of those individual documents inside\n// ?\ncategoryMap=querySnapshot.docs.reduce(function(acc,docSnapshot){// distructure off the values of the data of docSnapshot\nvar _docSnapshot$data=docSnapshot.data(),title=_docSnapshot$data.title,items=_docSnapshot$data.items;acc[title.toLowerCase()]=items;return acc;},[]);return _context2.abrupt(\"return\",categoryMap);case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function getCategoriesAndDocuments(){return _ref2.apply(this,arguments);};}();export var createUserDocumentFromAuth=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(userAuth){var additionalInformation,userDocRef,userSnapshot,displayName,email,createdAt,_args3=arguments;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:additionalInformation=_args3.length>1&&_args3[1]!==undefined?_args3[1]:{};if(userAuth){_context3.next=3;break;}return _context3.abrupt(\"return\");case 3:// Add a new document in collection \"users\"\nuserDocRef=doc(db,'users',userAuth.uid);_context3.next=6;return getDoc(userDocRef);case 6:userSnapshot=_context3.sent;if(userSnapshot.exists()){_context3.next=18;break;}displayName=userAuth.displayName,email=userAuth.email;createdAt=new Date();_context3.prev=10;_context3.next=13;return setDoc(userDocRef,_objectSpread({displayName:displayName,email:email,createdAt:createdAt},additionalInformation));case 13:_context3.next=18;break;case 15:_context3.prev=15;_context3.t0=_context3[\"catch\"](10);console.log('error creating the user',_context3.t0.message);case 18:return _context3.abrupt(\"return\",userDocRef);case 19:case\"end\":return _context3.stop();}}},_callee3,null,[[10,15]]);}));return function createUserDocumentFromAuth(_x3){return _ref3.apply(this,arguments);};}();export var createAuthUserWithEmailAndPassword=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(email,password){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:if(!(!email||!password)){_context4.next=2;break;}return _context4.abrupt(\"return\");case 2:_context4.next=4;return createUserWithEmailAndPassword(auth,email,password);case 4:return _context4.abrupt(\"return\",_context4.sent);case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function createAuthUserWithEmailAndPassword(_x4,_x5){return _ref4.apply(this,arguments);};}();export var signInAuthUserWithEmailAndPassword=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(email,password){return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(!(!email||!password)){_context5.next=2;break;}return _context5.abrupt(\"return\");case 2:_context5.next=4;return signInWithEmailAndPassword(auth,email,password);case 4:return _context5.abrupt(\"return\",_context5.sent);case 5:case\"end\":return _context5.stop();}}},_callee5);}));return function signInAuthUserWithEmailAndPassword(_x6,_x7){return _ref5.apply(this,arguments);};}();export var signOutAuthUser=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(){return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return signOut(auth);case 2:return _context6.abrupt(\"return\",_context6.sent);case 3:case\"end\":return _context6.stop();}}},_callee6);}));return function signOutAuthUser(){return _ref6.apply(this,arguments);};}();// https://firebase.google.com/docs/auth/web/manage-users\n// Manage Users\nexport var onAuthStateChangedListener=function onAuthStateChangedListener(callback){return onAuthStateChanged(auth,callback);};","map":{"version":3,"names":["initializeApp","getAuth","signInWithRedirect","signInWithPopup","GoogleAuthProvider","createUserWithEmailAndPassword","signInWithEmailAndPassword","signOut","onAuthStateChanged","getFirestore","doc","getDoc","setDoc","collection","writeBatch","query","getDocs","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","app","googleProvider","setCustomParameters","prompt","auth","signInWithGooglePopup","signInWithGoogleRedirect","db","addCollectionAndDocuments","collectionKey","objectsToAdd","collectionRef","batch","forEach","object","docRef","title","toLowerCase","set","commit","console","log","getCategoriesAndDocuments","q","querySnapshot","categoryMap","docs","reduce","acc","docSnapshot","data","items","createUserDocumentFromAuth","userAuth","additionalInformation","userDocRef","uid","userSnapshot","exists","displayName","email","createdAt","Date","message","createAuthUserWithEmailAndPassword","password","signInAuthUserWithEmailAndPassword","signOutAuthUser","onAuthStateChangedListener","callback"],"sources":["/Users/hanziniu/aureole-e-commerce/e-commerce/src/utils/firebase/firebase.utils.js"],"sourcesContent":["// Import the functions you need from the SDKs you need\nimport { initializeApp } from 'firebase/app';\nimport {\n  getAuth,\n  signInWithRedirect,\n  signInWithPopup,\n  GoogleAuthProvider,\n  createUserWithEmailAndPassword,\n  signInWithEmailAndPassword,\n  signOut,\n  onAuthStateChanged,\n} from 'firebase/auth';\n// TODO: Add SDKs for Firebase products that you want to use\n// https://firebase.google.com/docs/web/setup#available-libraries\n\nimport {\n  getFirestore,\n  doc,\n  getDoc,\n  setDoc,\n  collection,\n  writeBatch,\n  query,\n  getDocs,\n} from 'firebase/firestore';\n\n// upload these categories from that shop data up into the collections\n\n// Your web app's Firebase configuration\nconst firebaseConfig = {\n  apiKey: 'AIzaSyALOjtn7jZIEUziIpNHxVfeOdOEoQDP3V8',\n  authDomain: 'e-commerce-db-9450a.firebaseapp.com',\n  projectId: 'e-commerce-db-9450a',\n  storageBucket: 'e-commerce-db-9450a.appspot.com',\n  messagingSenderId: '731145164187',\n  appId: '1:731145164187:web:e34c39bf7ec0e911acfd3e',\n};\n\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\n\n// Create an instance of the Google provider object - https://firebase.google.com/docs/auth/web/google-signin\nconst googleProvider = new GoogleAuthProvider();\n\ngoogleProvider.setCustomParameters({\n  // Forces account selection even when one account\n  // is available.\n  prompt: 'select_account',\n});\n\n// Initialize Firebase Authentication\nexport const auth = getAuth();\n\nexport const signInWithGooglePopup = () =>\n  signInWithPopup(auth, googleProvider);\nexport const signInWithGoogleRedirect = () =>\n  signInWithRedirect(auth, googleProvider);\n\n// Initialize Cloud Firestore\nexport const db = getFirestore();\n\nexport const addCollectionAndDocuments = async (\n  collectionKey,\n  objectsToAdd\n) => {\n  const collectionRef = collection(db, collectionKey);\n\n  // init the batch and pass db\n  const batch = writeBatch(db);\n\n  objectsToAdd.forEach((object) => {\n    const docRef = doc(collectionRef, object.title.toLowerCase());\n    batch.set(docRef, object);\n  });\n\n  await batch.commit();\n  console.log('done');\n};\n\n//  best isolate and minimize the impact\nexport const getCategoriesAndDocuments = async () => {\n  // references : A reference is a lightweight object that just points to a location in your database.\n  // create references to the categories collection\n  const collectionRef = collection(db, 'categories');\n\n  // create a query against the categories collection\n  const q = query(collectionRef);\n\n  // Execute a query\n  // use get() to retrieve the results:\n  // getDocs() : Executes the query and returns the results as a QuerySnapshot.\n  const querySnapshot = await getDocs(q);\n  // A QuerySnapshot contains the results of a query. It can contain zero or more DocumentSnapshot objects.\n\n  // querySnapshot.docs will give an array of all of those individual documents inside\n  // ?\n  const categoryMap = querySnapshot.docs.reduce((acc, docSnapshot) => {\n    // distructure off the values of the data of docSnapshot\n    const { title, items } = docSnapshot.data();\n    acc[title.toLowerCase()] = items;\n    return acc;\n  }, []);\n\n  return categoryMap;\n};\n\nexport const createUserDocumentFromAuth = async (\n  userAuth,\n  additionalInformation = {}\n) => {\n  if (!userAuth) return;\n  // Add a new document in collection \"users\"\n  const userDocRef = doc(db, 'users', userAuth.uid);\n\n  const userSnapshot = await getDoc(userDocRef);\n\n  // check data exists\n  if (!userSnapshot.exists()) {\n    const { displayName, email } = userAuth;\n    const createdAt = new Date();\n\n    try {\n      await setDoc(userDocRef, {\n        displayName,\n        email,\n        createdAt,\n        ...additionalInformation,\n      });\n    } catch (error) {\n      console.log('error creating the user', error.message);\n    }\n  }\n\n  return userDocRef;\n};\n\nexport const createAuthUserWithEmailAndPassword = async (email, password) => {\n  if (!email || !password) return;\n\n  return await createUserWithEmailAndPassword(auth, email, password);\n};\n\nexport const signInAuthUserWithEmailAndPassword = async (email, password) => {\n  if (!email || !password) return;\n\n  return await signInWithEmailAndPassword(auth, email, password);\n};\nexport const signOutAuthUser = async () => await signOut(auth);\n\n// https://firebase.google.com/docs/auth/web/manage-users\n// Manage Users\nexport const onAuthStateChangedListener = (callback) =>\n  onAuthStateChanged(auth, callback);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}